%% Architecture diagram (Mermaid) - top-down flowchart
%% Render with: npx @mermaid-js/mermaid-cli -i docs/diagrams/architecture.mmd -o docs/diagrams/architecture.svg

%%{init: {"themeVariables": {"fontSize": "16px", "nodePadding": "16", "clusterBkg": "#f9f9f9"}}}%%
flowchart TB
   %% Top-down layout for better readability
   Frontend["Frontend (React)\nport 3000"]
   Order["Order Service\ncontainer: oms-order-service\nport: 8081"]
   Inventory["Inventory Service\ncontainer: oms-inventory-service\nport: 8082"]
   Rabbit["RabbitMQ\ncontainer: oms-rabbitmq\nports: 5672 / 15672"]
   RabbitMgmt["RabbitMQ Management\nport: 15672"]
   Mongo["MongoDB\ncontainer: oms-mongodb\nport: 27017\n(databases: order-db, inventory-db)"]
   MongoExpress["Mongo Express\ncontainer: oms-mongo-express\nport: 8888"]

   Frontend -->|HTTP REST| Order
   Order -->|Publish events| Rabbit
   Rabbit -->|Deliver events| Inventory
   Order -->|Reads / Writes| Mongo
   Inventory -->|Reads / Writes| Mongo
   Mongo --> MongoExpress
   Rabbit --> RabbitMgmt

   subgraph CodeModules["Code (not containers)"]
      Common["common module\n(shared library) - not a running service"]
   end
   Common -.-> Order
   Common -.-> Inventory
